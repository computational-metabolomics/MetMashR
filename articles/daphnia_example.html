<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MetMashR">
<title>Processing Annotations for LCMS of Daphnia samples â€¢ MetMashR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Processing Annotations for LCMS of Daphnia samples">
<meta property="og:description" content="MetMashR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-standard navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MetMashR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/using_MetMashR.html">Using MetMashR</a>
    <a class="dropdown-item" href="../articles/Extending_MetMashR.html">Extending MetMashR</a>
    <a class="dropdown-item" href="../articles/annotate_mixtures.html">Annotating mixtures of standards</a>
    <a class="dropdown-item" href="../articles/exploring_mtox.html">Exploring the MTox700+ database</a>
    <a class="dropdown-item" href="../articles/daphnia_example.html">Processing Annotations for LCMS of Daphnia samples</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/computational-metabolomics/MetMasheR" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.birmingham.ac.uk/research/activity/phenome-centre/index.aspx" aria-label="Phenome Centre Birmingham">
    <span class="fa fa-flask"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--">
    <span class="fa fa-music"></span>
     
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--">
    <a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/MetMashR.html">MetMashR</a>
    <a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/struct.html">struct</a>
    <a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/structToolbox.html">structToolbox</a>
    <a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/metabolomicsWorkbenchR.html">metabolmicsWorkbenchR</a>
    <a class="external-link dropdown-item" href="https://www.bioconductor.org/packages/release/bioc/html/pmp.html">pmp</a>
  </div>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Processing Annotations for LCMS of Daphnia samples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/computational-metabolomics/MetMashR/blob/HEAD/vignettes/daphnia_example.Rmd" class="external-link"><code>vignettes/daphnia_example.Rmd</code></a></small>
      <div class="d-none name"><code>daphnia_example.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The latest versions of <em><a href="https://bioconductor.org/packages/3.18/struct" class="external-link">struct</a></em> and
<code>MetMashR</code> that are compatible with your current R version
can be installed using BiocManager.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install BiocManager if not present</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># install MetMashR and dependencies</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"MetMashR"</span><span class="op">)</span></span></code></pre></div>
<p>Once installed you can activate the packages in the usual way:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">struct</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://computational-metabolomics.github.io/MetMashR/" class="external-link">MetMashR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">metabolomicsWorkbenchR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="import-daphina-data">Import Daphina data<a class="anchor" aria-label="anchor" href="#import-daphina-data"></a>
</h2>
<p>TODO</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import HILIC_POS</span></span>
<span><span class="va">HP</span> <span class="op">=</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/daphnia/daphnia_example.xlsx"</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span>,</span>
<span>        sheet<span class="op">=</span><span class="st">'HILIC_POS'</span>,</span>
<span>        rowNames<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        colNames<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># rename columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">HP</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">'id'</span></span>
<span><span class="co"># append assay to feature id</span></span>
<span><span class="va">HP</span><span class="op">$</span><span class="va">id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'HILIC_POS_'</span>,<span class="va">HP</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co"># convert some columns to numeric</span></span>
<span><span class="va">HP</span><span class="op">$</span><span class="va">rsd_qc</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">HP</span><span class="op">$</span><span class="va">rsd_qc</span><span class="op">)</span></span>
<span><span class="va">HP</span><span class="op">$</span><span class="va">rsd_sample</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">HP</span><span class="op">$</span><span class="va">rsd_sample</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import LIPIDS_POS</span></span>
<span><span class="va">LP</span> <span class="op">=</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/daphnia/daphnia_example.xlsx"</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span>,</span>
<span>        sheet<span class="op">=</span><span class="st">'LIPIDS_POS'</span>,</span>
<span>        rowNames<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        colNames<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># rename columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">LP</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">'id'</span></span>
<span><span class="co"># append assay to feature id</span></span>
<span><span class="va">LP</span><span class="op">$</span><span class="va">id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'LIPIDS_POS_'</span>,<span class="va">LP</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="co"># convert some columns to numeric</span></span>
<span><span class="va">LP</span><span class="op">$</span><span class="va">rsd_qc</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">LP</span><span class="op">$</span><span class="va">rsd_qc</span><span class="op">)</span></span>
<span><span class="va">LP</span><span class="op">$</span><span class="va">rsd_sample</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">LP</span><span class="op">$</span><span class="va">rsd_sample</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="import-and-clean-compound-discoverer-annotations">Import and clean Compound Discoverer annotations<a class="anchor" aria-label="anchor" href="#import-and-clean-compound-discoverer-annotations"></a>
</h2>
<p>Here we implement a workflow to process the Compound Discoverer
outputs for each assay. Labels are added to aid with filtering in later
steps. For duplicate annotations we select the annotation with the
highest mzCloud match score. We retain annotations with a Full Match and
disregard the rest. Finally we match the MS2 peaks to the MS1 peaks.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cd_workflow</span> <span class="op">=</span> </span>
<span>    <span class="co"># import source</span></span>
<span>    <span class="fu"><a href="../reference/import_source.html">import_source</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># add useful labels</span></span>
<span>    <span class="fu"><a href="../reference/add_labels.html">add_labels</a></span><span class="op">(</span></span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            source_name <span class="op">=</span> <span class="st">'CD'</span>,</span>
<span>            assay <span class="op">=</span> <span class="st">'placeholder'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># placeholder replaced later</span></span>
<span>    </span>
<span>    <span class="co"># filter low quality</span></span>
<span>    <span class="fu"><a href="../reference/filter_labels.html">filter_labels</a></span><span class="op">(</span></span>
<span>        column_name <span class="op">=</span> <span class="st">'compound_match'</span>,</span>
<span>        labels <span class="op">=</span> <span class="st">'Full match'</span>,</span>
<span>        mode <span class="op">=</span> <span class="st">'include'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># resolve duplicates</span></span>
<span>    <span class="fu"><a href="../reference/combine_records.html">combine_records</a></span><span class="op">(</span></span>
<span>        group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'compound'</span>,<span class="st">'ion'</span><span class="op">)</span>,</span>
<span>        default_fcn <span class="op">=</span> <span class="fu"><a href="../reference/combine_records_helper_functions.html">.select_max</a></span><span class="op">(</span></span>
<span>            max_col <span class="op">=</span> <span class="st">'mzcloud_score'</span>,</span>
<span>            keep_NA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            use_abs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="co"># match MS1 to MS2</span></span>
<span>    <span class="fu"><a href="../reference/mzrt_match.html">mzrt_match</a></span><span class="op">(</span></span>
<span>        variable_meta <span class="op">=</span> <span class="va">HP</span>,</span>
<span>        mz_column <span class="op">=</span> <span class="st">'mz'</span>,</span>
<span>        rt_column <span class="op">=</span> <span class="st">'rt'</span>,</span>
<span>        ppm_window <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        rt_window <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        id_column <span class="op">=</span> <span class="st">'id'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># ppm difference MS1 vs library</span></span>
<span>    <span class="fu"><a href="../reference/calc_ppm_diff.html">calc_ppm_diff</a></span><span class="op">(</span></span>
<span>        obs_mz_column <span class="op">=</span> <span class="st">'mz_match'</span>,</span>
<span>        ref_mz_column <span class="op">=</span> <span class="st">'theoretical_mz'</span>,</span>
<span>        out_column <span class="op">=</span> <span class="st">'ms1_lib_ppm_diff'</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<p>We need to apply this workflow to each assay. For convenience we
store the sources for each assay in a list.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare sources</span></span>
<span><span class="va">cd_sources</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    HILIC_POS <span class="op">=</span> <span class="fu"><a href="../reference/cd_source.html">cd_source</a></span><span class="op">(</span></span>
<span>        source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>                <span class="st">'extdata/daphnia/HILIC_POS_EL_CD.xlsx'</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>            <span class="st">'extdata/daphnia/HILIC_POS_EL_CD_comp.xlsx'</span>,</span>
<span>            package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        sheets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Compounds'</span>,<span class="st">'Compounds'</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    LIPIDS_POS <span class="op">=</span> <span class="fu"><a href="../reference/cd_source.html">cd_source</a></span><span class="op">(</span></span>
<span>        source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>                <span class="st">'extdata/daphnia/LIPIDS_POS_EL_CD.xlsx'</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>            <span class="st">'extdata/daphnia/LIPIDS_POS_EL_CD_comp.xlsx'</span>,</span>
<span>            package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        sheets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Compounds'</span>,<span class="st">'Compounds'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we are ready to apply the workflow to the sources. Note that
because the labels we are adding are specific to the assay we need to
update this input parameter of the workflow before apply it to the
source. Again we store the applied workflow in a list for
convenience.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># place to store results</span></span>
<span><span class="va">CD</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set labels</span></span>
<span><span class="va">cd_workflow</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">assay</span><span class="op">=</span><span class="st">'HILIC_POS'</span> </span>
<span><span class="co"># apply workflow</span></span>
<span><span class="va">CD</span><span class="op">$</span><span class="va">HILIC_POS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/model_apply.html" class="external-link">model_apply</a></span><span class="op">(</span><span class="va">cd_workflow</span>,<span class="va">cd_sources</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set labels</span></span>
<span><span class="va">cd_workflow</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">assay</span><span class="op">=</span><span class="st">'LIPIDS_POS'</span> </span>
<span><span class="co"># apply workflow</span></span>
<span><span class="va">CD</span><span class="op">$</span><span class="va">LIPIDS_POS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/model_apply.html" class="external-link">model_apply</a></span><span class="op">(</span><span class="va">cd_workflow</span>,<span class="va">cd_sources</span><span class="op">$</span><span class="va">LIPIDS_POS</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<div class="section level4">
<h4 id="cd-quality-assurance">CD Quality Assurance<a class="anchor" aria-label="anchor" href="#cd-quality-assurance"></a>
</h4>
<p>In the CD workflow we computed ppm and retention time differences
between the mzCloud library used by Compound Discoverer and the MS2
experimental data.</p>
<p>If the peak of the distribution is off centre this can be indicative
of e.g.Â retention time or m/z drift.</p>
<p>If there are a lot of annotations with a large difference vs the
library then these can be excluded by adding e.g.Â a
<code>filter_range</code> workflow step.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MS2 vs library</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram.html">annotation_histogram</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'library_ppm_diff'</span>,</span>
<span>    vline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">CD</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'MS2 vs library'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MS1 vs library</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram.html">annotation_histogram</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'ms1_lib_ppm_diff'</span>,</span>
<span>    vline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">CD</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'MS1 vs library'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># layout</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span>,nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The ppm and retention time differences between the MS1 and MS2
features (peaks) can also be indicative of analytical problems.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare chart</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram2d.html">annotation_histogram2d</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ppm_match_diff_an'</span>,<span class="st">'rt_match_diff'</span><span class="op">)</span>,</span>
<span>    bins <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">CD</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The LIPID_POS assay (not shown) only has 2 matches, so the chart is
not informative for that assay.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="import-and-clean-lipidsearch-annotations">Import and clean LipidSearch annotations<a class="anchor" aria-label="anchor" href="#import-and-clean-lipidsearch-annotations"></a>
</h3>
<p>Similarly to the CD sources, here we implement a workflow to process
the LipidSearch outputs for each assay. Labels are added to aid with
filtering in later steps. For duplicate annotations we select the
annotation with the lowest ppm difference vs the library. We retain only
LS annotations with Grades A and B.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># prepare workflow</span></span>
<span><span class="va">ls_workflow</span> <span class="op">=</span> </span>
<span></span>
<span>    <span class="co"># import raw file</span></span>
<span>    <span class="fu"><a href="../reference/import_source.html">import_source</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>    </span>
<span>    <span class="co"># add labels</span></span>
<span>    <span class="fu"><a href="../reference/add_labels.html">add_labels</a></span><span class="op">(</span></span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            assay <span class="op">=</span> <span class="st">'placeholder'</span>, <span class="co"># will be replaced later</span></span>
<span>            source_name <span class="op">=</span> <span class="st">'LS'</span></span>
<span>        <span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span></span>
<span>    <span class="co"># filter by grade</span></span>
<span>    <span class="fu"><a href="../reference/filter_labels.html">filter_labels</a></span><span class="op">(</span></span>
<span>        column_name <span class="op">=</span> <span class="st">'Grade'</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span><span class="op">)</span>,</span>
<span>        mode <span class="op">=</span> <span class="st">'include'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># resolve duplicates</span></span>
<span>    <span class="fu"><a href="../reference/combine_records.html">combine_records</a></span><span class="op">(</span></span>
<span>        group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'LipidIon'</span><span class="op">)</span>,</span>
<span>        default_fcn <span class="op">=</span> <span class="fu"><a href="../reference/combine_records_helper_functions.html">.select_min</a></span><span class="op">(</span></span>
<span>            min_col <span class="op">=</span> <span class="st">'library_ppm_diff'</span>,</span>
<span>            keep_NA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            use_abs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span> </span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># match MS1 to MS2</span></span>
<span>    <span class="fu"><a href="../reference/mzrt_match.html">mzrt_match</a></span><span class="op">(</span></span>
<span>        variable_meta <span class="op">=</span> <span class="va">HP</span>,</span>
<span>        mz_column <span class="op">=</span> <span class="st">'mz'</span>,</span>
<span>        rt_column <span class="op">=</span> <span class="st">'rt'</span>,</span>
<span>        ppm_window <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        rt_window <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        id_column <span class="op">=</span> <span class="st">'id'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># ppm difference MS1 vs library</span></span>
<span>    <span class="fu"><a href="../reference/calc_ppm_diff.html">calc_ppm_diff</a></span><span class="op">(</span></span>
<span>        obs_mz_column <span class="op">=</span> <span class="st">'mz_match'</span>,</span>
<span>        ref_mz_column <span class="op">=</span> <span class="st">'theor_mass'</span>,</span>
<span>        out_column <span class="op">=</span> <span class="st">'ms1_lib_ppm_diff'</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<p>Next we prepare the LipidSearch source objects:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare sources</span></span>
<span><span class="va">ls_sources</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    HILIC_POS <span class="op">=</span> <span class="fu"><a href="../reference/ls_source.html">ls_source</a></span><span class="op">(</span></span>
<span>        source <span class="op">=</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>                <span class="st">'extdata/daphnia/HILIC_POS_EL_LS.txt'</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    LIPIDS_POS <span class="op">=</span> <span class="fu"><a href="../reference/ls_source.html">ls_source</a></span><span class="op">(</span></span>
<span>        source <span class="op">=</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>                <span class="st">'extdata/daphnia/LIPIDS_POS_EL_LS.txt'</span>,</span>
<span>                package <span class="op">=</span> <span class="st">'MetMashR'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we can apply the LipidSearch workflow to the LipidSearch
sources:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># place to store results</span></span>
<span><span class="va">LS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set labels</span></span>
<span><span class="va">ls_workflow</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">assay</span><span class="op">=</span><span class="st">'HILIC_POS'</span> </span>
<span><span class="co"># apply workflow</span></span>
<span><span class="va">LS</span><span class="op">$</span><span class="va">HILIC_POS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/model_apply.html" class="external-link">model_apply</a></span><span class="op">(</span><span class="va">ls_workflow</span>,<span class="va">ls_sources</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set labels</span></span>
<span><span class="va">ls_workflow</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">assay</span><span class="op">=</span><span class="st">'LIPIDS_POS'</span> </span>
<span><span class="co"># apply workflow</span></span>
<span><span class="va">LS</span><span class="op">$</span><span class="va">LIPIDS_POS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/model_apply.html" class="external-link">model_apply</a></span><span class="op">(</span><span class="va">ls_workflow</span>,<span class="va">ls_sources</span><span class="op">$</span><span class="va">LIPIDS_POS</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<div class="section level4">
<h4 id="ls-quality-assurance">LS Quality Assurance<a class="anchor" aria-label="anchor" href="#ls-quality-assurance"></a>
</h4>
<p>We can assess drift in m/z and/or retention time using histograms of
ppm and differences vs the library like we did before.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MS2 vs library</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram.html">annotation_histogram</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'library_ppm_diff'</span>,</span>
<span>    vline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">LS</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'MS2 vs library'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MS1 vs library</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram.html">annotation_histogram</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'ms1_lib_ppm_diff'</span>,</span>
<span>    vline <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">LS</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'MS1 vs library'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># layout</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span>,nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-14-1.png" width="700" style="display: block; margin: auto;"></p>
<p>We can also check for analytical issue by comparing the MS1 and MS2
ppm and retention time differences.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare chart</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram2d.html">annotation_histogram2d</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ppm_match_diff_an'</span>,<span class="st">'rt_match_diff'</span><span class="op">)</span>,</span>
<span>    bins <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">LS</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="mashing-all-sources-assays">Mashing all sources / assays<a class="anchor" aria-label="anchor" href="#mashing-all-sources-assays"></a>
</h2>
<p>Now that we have imported and cleaned the individual sources we can
combine them into a single annotation_table. This table can the be
further cleaned and augmented with additional information as
required.</p>
<p>Here, we use the <code>normalise_strings</code> object to clean and
tidy metabolite names to improve matches when searching for inchikeyâ€™s
using PubChem and LipidMaps APIs.</p>
<p>We then use the inchikeyâ€™s to obtain pathway information from the
PathBank metabolite database.</p>
<p>Imported statistics for the MS1 peaks are joined with the annotation
table and used to quality filter the MS1 peaks based on an assessment of
quality (RSD of the QC samples &lt; 30).</p>
<p>Finally, we collapse the table such that each MS1 peak has a list of
possible annotations.</p>
<p>For the vignette we used cached results, which we prepare now.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cache1</span><span class="op">=</span><span class="fu"><a href="../reference/rds_database.html">rds_database</a></span><span class="op">(</span></span>
<span>    source<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cached'</span>,package<span class="op">=</span><span class="st">'MetMashR'</span><span class="op">)</span>,<span class="st">'cache1.rds'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cache2</span><span class="op">=</span><span class="fu"><a href="../reference/rds_database.html">rds_database</a></span><span class="op">(</span>    </span>
<span> source<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cached'</span>,package<span class="op">=</span><span class="st">'MetMashR'</span><span class="op">)</span>,<span class="st">'cache2.rds'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cache3</span><span class="op">=</span><span class="fu"><a href="../reference/rds_database.html">rds_database</a></span><span class="op">(</span></span>
<span> source<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cached'</span>,package<span class="op">=</span><span class="st">'MetMashR'</span><span class="op">)</span>,<span class="st">'cache3.rds'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cache4</span><span class="op">=</span><span class="fu"><a href="../reference/rds_database.html">rds_database</a></span><span class="op">(</span></span>
<span> source<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'cached'</span>,package<span class="op">=</span><span class="st">'MetMashR'</span><span class="op">)</span>,<span class="st">'cache4.rds'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next we prepare the workflow and then apply it.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WF</span> <span class="op">=</span> </span>
<span>    <span class="fu"><a href="../reference/combine_sources.html">combine_sources</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">CD</span><span class="op">$</span><span class="va">LIPIDS_POS</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">LS</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">LS</span><span class="op">$</span><span class="va">LIPIDS_POS</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        source_col <span class="op">=</span> <span class="st">'annotation_source'</span>,</span>
<span>        keep_cols <span class="op">=</span> <span class="st">'.all'</span>,</span>
<span>        matching_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            Compound <span class="op">=</span> <span class="st">'compound'</span>, </span>
<span>            Compound <span class="op">=</span> <span class="st">'LipidName'</span>,</span>
<span>            Ion <span class="op">=</span> <span class="st">'ion'</span>,</span>
<span>            Ion <span class="op">=</span> <span class="st">'LipidIon'</span>,</span>
<span>            theoretical_mz <span class="op">=</span> <span class="st">'theor_mass'</span>,</span>
<span>            LipidClass <span class="op">=</span> <span class="st">'Class'</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/normalise_strings.html">normalise_strings</a></span><span class="op">(</span></span>
<span>        search_column <span class="op">=</span> <span class="st">'Compound'</span>,</span>
<span>        output_column <span class="op">=</span> <span class="st">'normalised_compound'</span>,</span>
<span>        dictionary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="co"># custom dictionary</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                <span class="co"># replace "NP" with "Compound NP"</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                    pattern <span class="op">=</span> <span class="st">'^NP-'</span>,</span>
<span>                    replace <span class="op">=</span> <span class="st">'Compound NP-'</span><span class="op">)</span>,</span>
<span>                <span class="co"># remove terms in trailing brackets e.g." (ATP)" </span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                    pattern <span class="op">=</span> <span class="st">'\\ \\([^\\)]*\\)$'</span>,</span>
<span>                    replace <span class="op">=</span> <span class="st">''</span><span class="op">)</span>,</span>
<span>                <span class="co"># replace known abbreviations</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                    pattern <span class="op">=</span> <span class="st">'3-Fluoro NNEI'</span>,</span>
<span>                    replace <span class="op">=</span> <span class="st">'3-Fluoro-nnei'</span>,</span>
<span>                    fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                    pattern <span class="op">=</span> <span class="st">'Î¥-L-Glutamyl-L-glutamic acid'</span>,</span>
<span>                    replace <span class="op">=</span> <span class="st">'Tyr-Glu-Glu'</span></span>
<span>                <span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                    pattern <span class="op">=</span> <span class="st">'AcCa'</span>,</span>
<span>                    replace <span class="op">=</span> <span class="st">'CAR'</span></span>
<span>                <span class="op">)</span></span>
<span>            <span class="op">)</span>,</span>
<span>            <span class="co"># update tripeptides</span></span>
<span>            <span class="va">.tripeptide_dictionary</span>,</span>
<span>            <span class="co"># remove racemic information</span></span>
<span>            <span class="va">.racemic_dictionary</span>,</span>
<span>            <span class="co"># replace greek characters</span></span>
<span>            <span class="va">.greek_dictionary</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/pubchem_property_lookup.html">pubchem_property_lookup</a></span><span class="op">(</span></span>
<span>        query_column <span class="op">=</span> <span class="st">'normalised_compound'</span>,</span>
<span>        search_by <span class="op">=</span> <span class="st">'name'</span>,</span>
<span>        property <span class="op">=</span> <span class="st">'InChIKey'</span>,</span>
<span>        suffix <span class="op">=</span> <span class="st">'_pubchem'</span>,</span>
<span>        cache <span class="op">=</span> <span class="va">cache1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/lipidmaps_lookup.html">lipidmaps_lookup</a></span><span class="op">(</span></span>
<span>        query_column <span class="op">=</span> <span class="st">'normalised_compound'</span>,</span>
<span>        context <span class="op">=</span> <span class="st">'compound'</span>,</span>
<span>        context_item <span class="op">=</span> <span class="st">'abbrev'</span>,</span>
<span>        output_item <span class="op">=</span> <span class="st">'inchi_key'</span>,</span>
<span>        suffix <span class="op">=</span> <span class="st">'_abbrev'</span>,</span>
<span>        cache <span class="op">=</span> <span class="va">cache2</span></span>
<span>    <span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/lipidmaps_lookup.html">lipidmaps_lookup</a></span><span class="op">(</span></span>
<span>        query_column <span class="op">=</span> <span class="st">'normalised_compound'</span>,</span>
<span>        context <span class="op">=</span> <span class="st">'compound'</span>,</span>
<span>        context_item <span class="op">=</span> <span class="st">'abbrev_chains'</span>,</span>
<span>        output_item <span class="op">=</span> <span class="st">'inchi_key'</span>,</span>
<span>        suffix <span class="op">=</span> <span class="st">'_abbrevchains'</span>,</span>
<span>        cache <span class="op">=</span> <span class="va">cache3</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/combine_columns.html">combine_columns</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'InChIKey_pubchem'</span>,<span class="st">'inchi_key_abbrev'</span>,<span class="st">'inchi_key_abbrevchains'</span><span class="op">)</span>,</span>
<span>        output_name <span class="op">=</span> <span class="st">'inchikey'</span>,</span>
<span>        source_name <span class="op">=</span> <span class="st">'inchikey_src'</span>,</span>
<span>        source_tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pubchem'</span>,<span class="st">'lm_abbrev'</span>,<span class="st">'lm_chains'</span><span class="op">)</span>,</span>
<span>        clean <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/classyfire_lookup.html">classyfire_lookup</a></span><span class="op">(</span></span>
<span>        query_column <span class="op">=</span> <span class="st">'inchikey'</span>,</span>
<span>        output_items <span class="op">=</span> <span class="st">'.all'</span>,</span>
<span>        output_fields <span class="op">=</span> <span class="st">'.all'</span>,suffix <span class="op">=</span> <span class="st">'_cf'</span>,</span>
<span>        cache <span class="op">=</span> <span class="va">cache4</span>,</span>
<span>        delay <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/database_lookup.html">database_lookup</a></span><span class="op">(</span></span>
<span>        query_column <span class="op">=</span> <span class="st">'inchikey'</span>,</span>
<span>        database_column <span class="op">=</span> <span class="st">'InChI.Key'</span>,</span>
<span>        database <span class="op">=</span> <span class="fu"><a href="../reference/PathBank_metabolite_database.html">PathBank_metabolite_database</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Pathway.Name'</span>,<span class="st">'Pathway.Subject'</span>,<span class="st">'Species'</span><span class="op">)</span>,</span>
<span>        suffix <span class="op">=</span> <span class="st">''</span>,</span>
<span>        not_found <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/add_columns.html">add_columns</a></span><span class="op">(</span></span>
<span>        new_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">HP</span>,<span class="va">LP</span><span class="op">)</span>,</span>
<span>        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'mzrt_match_id'</span><span class="op">=</span><span class="st">'id'</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/filter_na.html">filter_na</a></span><span class="op">(</span></span>
<span>        column_name <span class="op">=</span> <span class="st">'inchikey'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/combine_records.html">combine_records</a></span><span class="op">(</span></span>
<span>        group_by <span class="op">=</span> <span class="st">'mzrt_match_id'</span>,</span>
<span>        default_fcn <span class="op">=</span> <span class="fu"><a href="../reference/combine_records_helper_functions.html">.unique</a></span><span class="op">(</span></span>
<span>            separator <span class="op">=</span> <span class="st">' || '</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/filter_labels.html">filter_labels</a></span><span class="op">(</span></span>
<span>        column_name <span class="op">=</span> <span class="st">'rsd_qc'</span>,</span>
<span>        labels <span class="op">=</span> <span class="st">'NA'</span>,</span>
<span>        mode <span class="op">=</span> <span class="st">'exclude'</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/filter_range.html">filter_range</a></span><span class="op">(</span></span>
<span>        column_name <span class="op">=</span> <span class="st">'rsd_qc'</span>,</span>
<span>        upper_limit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        lower_limit<span class="op">=</span><span class="op">-</span><span class="cn">Inf</span>,</span>
<span>        equal_to<span class="op">=</span><span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">WF</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/struct/man/model_apply.html" class="external-link">model_apply</a></span><span class="op">(</span><span class="va">WF</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">CD</span><span class="op">$</span><span class="va">HILIC_POS</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can explore the contents of the table. Here we generate plots to
visualise the number of annotations from each source.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pie chart of the sources of annotations</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_pie_chart.html">annotation_pie_chart</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'source_name'</span>,</span>
<span>    label_location <span class="op">=</span> <span class="st">'outside'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">WF</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Annotations per source'</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-18-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Next we plot a histogram of the QC-RSD values before filtering, by
indexing the relevant step of the workflow.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># histogram of the rsd-qc for annotated features (before filtering)</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_histogram.html">annotation_histogram</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'rsd_qc'</span>,</span>
<span>    bins <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    vline <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">WF</span><span class="op">[</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'MS1 peak QC-RSD'</span>,<span class="st">"Features with QC-RSD&lt;20 were removed by the workflow."</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-19-1.png" width="700" style="display: block; margin: auto;"></p>
<p>In this plot we present a bar chart of the different molecular
classes present in the final table.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bar chart of the superclasses</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/annotation_bar_chart.html">annotation_bar_chart</a></span><span class="op">(</span></span>
<span>    factor_name <span class="op">=</span> <span class="st">'superclass.name_cf'</span>,</span>
<span>    legend <span class="op">=</span> <span class="cn">TRUE</span>,label_type <span class="op">=</span> <span class="st">'none'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">WF</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Superclasses'</span><span class="op">)</span></span></code></pre></div>
<p><img src="daphnia_example_files/figure-html/unnamed-chunk-20-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Finally we use the PubChem API to generate an image of the molecular
structure for one of the metabolites.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># display one of the metabolite structures</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="../reference/pubchem_widget.html">pubchem_widget</a></span><span class="op">(</span></span>
<span>        query_column <span class="op">=</span> <span class="st">'normalised_compound'</span>,</span>
<span>        row_index<span class="op">=</span><span class="fl">1</span>,</span>
<span>        record_type <span class="op">=</span> <span class="st">'3D-Conformer'</span>,</span>
<span>        display <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        hide_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        height <span class="op">=</span> <span class="st">'820px'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/struct/man/chart_plot.html" class="external-link">chart_plot</a></span><span class="op">(</span><span class="va">C</span>,<span class="fu"><a href="https://rdrr.io/pkg/struct/man/predicted.html" class="external-link">predicted</a></span><span class="op">(</span><span class="va">WF</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<iframe class="pubchem-widget" src="https://pubchem.ncbi.nlm.nih.gov/compound/Aminoethylethanolamine#section=3D-Conformer&amp;embed=true" style="width: 100%; height: 820px; border: 0;"></iframe>
<p><br></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] patchwork_1.2.0               ggplot2_3.4.4                </span></span>
<span><span class="co">#&gt; [3] metabolomicsWorkbenchR_1.12.0 MetMashR_0.1.0               </span></span>
<span><span class="co">#&gt; [5] struct_1.14.0                 BiocStyle_2.30.0             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] DBI_1.2.1                   bitops_1.0-7               </span></span>
<span><span class="co">#&gt;   [3] gridExtra_2.3               rlang_1.1.3                </span></span>
<span><span class="co">#&gt;   [5] magrittr_2.0.3              matrixStats_1.2.0          </span></span>
<span><span class="co">#&gt;   [7] e1071_1.7-14                compiler_4.3.2             </span></span>
<span><span class="co">#&gt;   [9] RSQLite_2.3.4               systemfonts_1.0.5          </span></span>
<span><span class="co">#&gt;  [11] vctrs_0.6.5                 stringr_1.5.1              </span></span>
<span><span class="co">#&gt;  [13] pkgconfig_2.0.3             crayon_1.5.2               </span></span>
<span><span class="co">#&gt;  [15] fastmap_1.1.1               dbplyr_2.4.0               </span></span>
<span><span class="co">#&gt;  [17] XVector_0.42.0              labeling_0.4.3             </span></span>
<span><span class="co">#&gt;  [19] utf8_1.2.4                  rmarkdown_2.25             </span></span>
<span><span class="co">#&gt;  [21] structToolbox_1.14.0        ragg_1.2.7                 </span></span>
<span><span class="co">#&gt;  [23] purrr_1.0.2                 bit_4.0.5                  </span></span>
<span><span class="co">#&gt;  [25] xfun_0.41                   MultiAssayExperiment_1.28.0</span></span>
<span><span class="co">#&gt;  [27] zlibbioc_1.48.0             cachem_1.0.8               </span></span>
<span><span class="co">#&gt;  [29] GenomeInfoDb_1.38.5         jsonlite_1.8.8             </span></span>
<span><span class="co">#&gt;  [31] blob_1.2.4                  highr_0.10                 </span></span>
<span><span class="co">#&gt;  [33] DelayedArray_0.28.0         R6_2.5.1                   </span></span>
<span><span class="co">#&gt;  [35] bslib_0.6.1                 stringi_1.8.3              </span></span>
<span><span class="co">#&gt;  [37] GenomicRanges_1.54.1        jquerylib_0.1.4            </span></span>
<span><span class="co">#&gt;  [39] Rcpp_1.0.12                 bookdown_0.37              </span></span>
<span><span class="co">#&gt;  [41] SummarizedExperiment_1.32.0 knitr_1.45                 </span></span>
<span><span class="co">#&gt;  [43] IRanges_2.36.0              Matrix_1.6-5               </span></span>
<span><span class="co">#&gt;  [45] tidyselect_1.2.0            abind_1.4-5                </span></span>
<span><span class="co">#&gt;  [47] yaml_2.3.8                  curl_5.2.0                 </span></span>
<span><span class="co">#&gt;  [49] lattice_0.22-5              tibble_3.2.1               </span></span>
<span><span class="co">#&gt;  [51] plyr_1.8.9                  Biobase_2.62.0             </span></span>
<span><span class="co">#&gt;  [53] withr_3.0.0                 evaluate_0.23              </span></span>
<span><span class="co">#&gt;  [55] ontologyIndex_2.11          desc_1.4.3                 </span></span>
<span><span class="co">#&gt;  [57] sf_1.0-15                   units_0.8-5                </span></span>
<span><span class="co">#&gt;  [59] proxy_0.4-27                BiocFileCache_2.10.1       </span></span>
<span><span class="co">#&gt;  [61] zip_2.3.0                   pillar_1.9.0               </span></span>
<span><span class="co">#&gt;  [63] BiocManager_1.30.22         filelock_1.0.3             </span></span>
<span><span class="co">#&gt;  [65] MatrixGenerics_1.14.0       KernSmooth_2.23-22         </span></span>
<span><span class="co">#&gt;  [67] stats4_4.3.2                generics_0.1.3             </span></span>
<span><span class="co">#&gt;  [69] sp_2.1-2                    RCurl_1.98-1.14            </span></span>
<span><span class="co">#&gt;  [71] S4Vectors_0.40.2            munsell_0.5.0              </span></span>
<span><span class="co">#&gt;  [73] scales_1.3.0                class_7.3-22               </span></span>
<span><span class="co">#&gt;  [75] glue_1.7.0                  tools_4.3.2                </span></span>
<span><span class="co">#&gt;  [77] data.table_1.14.10          openxlsx_4.2.5.2           </span></span>
<span><span class="co">#&gt;  [79] fs_1.6.3                    cowplot_1.1.2              </span></span>
<span><span class="co">#&gt;  [81] grid_4.3.2                  colorspace_2.1-0           </span></span>
<span><span class="co">#&gt;  [83] GenomeInfoDbData_1.2.11     cli_3.6.2                  </span></span>
<span><span class="co">#&gt;  [85] textshaping_0.3.7           fansi_1.0.6                </span></span>
<span><span class="co">#&gt;  [87] ggthemes_5.0.0              S4Arrays_1.2.0             </span></span>
<span><span class="co">#&gt;  [89] dplyr_1.1.4                 gtable_0.3.4               </span></span>
<span><span class="co">#&gt;  [91] sass_0.4.8                  digest_0.6.34              </span></span>
<span><span class="co">#&gt;  [93] BiocGenerics_0.48.1         classInt_0.4-10            </span></span>
<span><span class="co">#&gt;  [95] SparseArray_1.2.3           farver_2.1.1               </span></span>
<span><span class="co">#&gt;  [97] memoise_2.0.1               htmltools_0.5.7            </span></span>
<span><span class="co">#&gt;  [99] pkgdown_2.0.7               lifecycle_1.0.4            </span></span>
<span><span class="co">#&gt; [101] httr_1.4.7                  bit64_4.0.5</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Gavin Rhys Lloyd, Ralf Johannes Maria Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
